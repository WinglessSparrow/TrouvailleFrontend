@using Blazorise

@inject NavigationManager NavMan
@inject ILocalStorage local

<div class="header">
    <div class="logo" @onclick="ToMain"></div>
    <div class="search-bar">
        <input id="search" type="text">
        <button>
            <Icon Name="IconName.Search" />
        </button>
    </div>
    <div class="variable-icons">
        <div class="dropdown-indicator">
            <Icon Name="IconName.ShoppingCart" />
            <div class="dropdown-content">
                <a href="/ShopingCart">Shopping Cart
                    <Icon Name="IconName.ShoppingBasket" />
                </a>
                <a href="/Checkout">Checkout
                    <Icon Name="IconName.CreditCard" />
                </a>
            </div>
        </div>

        @if (_token != null)
        {
            @if (_token.AuthToken != "")
            {
                <div class="dropdown-indicator">
                    <Icon Name="IconName.User" />
                    <div class="dropdown-content">
                        <a href="/Account">Account Settings <i class="fas fa-user-cog  "></i></a>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="dropdown-indicator">
                <Icon Name="IconName.Lock" />
                <div class="dropdown-content">
                    <a href="/Register">Register
                        <i class="fas fa-clipboard-list"></i>
                    </a>
                    @* TODO Login; NOT redirection! *@
                    <a href="">Login
                        <Icon Name="IconName.Key" />
                    </a>
                </div>
            </div>
        }
    </div>
</div>


@code{
    private TokenModel _token { get; set; }

    protected override async Task OnInitializedAsync()
    {
        _token = await local.GetStorageAsync<TokenModel>("authToken");
    }


    private void ToMain()
    {
        NavMan.NavigateTo("/");
    }
}